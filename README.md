# APIs for CRUD, JWT based login and Two-Factor Authentication using FastAPI

This repository uses [FastAPI](https://fastapi.tiangolo.com) for creating APIs and many other python libraries such as:-
[SqlAlchemy](https://docs.sqlalchemy.org/en/14/dialects/sqlite.html) Python sql database library to maintain the CRUD operation data.
[Jose](https://pypi.org/project/python-jose/) is used for encrypting the login using JSON Web Tokens(JWT) and sign-in using algorithms.
[Passlib](https://pypi.org/project/passlib/) is used for hashing and verifying a hashed password.
[FastapiMail](https://pypi.org/project/fastapi-mail/) is used for sending the mail for reseting the password.
[PyOTP](https://pypi.org/project/pyotp/) is used for generating and verifying one-time passwords.

To access the Swagger UI for the application, click on the URL. https://crudfastapi.herokuapp.com/docs

To generate the QR Code from the Base64 text(data) goto:- https://codebeautify.org/base64-to-image-converter

## Installtion

```sh
git clone https://github.com/Ritesh-Kumar-Mandal/Auth.git
cd Auth
py -m venv venv 
source venv/Scripts/activate 
pip3 install -r requirements.txt
uvicorn main:app --reload
```

## Login and SignUp Panel
![Auth](https://github.com/Ritesh-Kumar-Mandal/Auth/blob/fad7613cb7c6b49d586e49b63585b67e7a27ccec/ScreenShots/APIs/admin-controls.png)
You can obtain the login token by entering your username (AS Email) and password, or if 2FA is enabled, your username and a one-time pin generated by the Authenticator app.

If you are a new user you can register yourself using the Register API.

In addition, if you are a current user who has forgotten your password, you can use the Forgot and Reset Password feature to generate a new password by receiving an email at your registered email address.

## Admin panel
![Admin](https://github.com/Ritesh-Kumar-Mandal/Auth/blob/fad7613cb7c6b49d586e49b63585b67e7a27ccec/ScreenShots/APIs/admin-controls.png)
Admin users have more CRUD control than regular users, for example, Admin can change or update any User information.

## User panel
![User](https://github.com/Ritesh-Kumar-Mandal/Auth/blob/fad7613cb7c6b49d586e49b63585b67e7a27ccec/ScreenShots/APIs/user-controls.png)
Users have less CRUD control than administrators. The current user can view, change or update his or her own information, which is stored in the database.

## JWT
After entering the correct login credentials, the user will receive a JSON Web Token that will be valid for an hour or until the user logs out.

## roleCheckerUtil
Contains a method for checking the user role, which controls the user's access level, i.e. a normal user is not permitted to perform admin level actions.

## 2FA Setup
After entering the necessary information, a user who has not yet enabled 2FA can do so by obtaining the QR (Base64 encrypted text as data) and registering in any Authenticator app such as Microsoft Authenticator, Google Authenticator, or any other. 

![qrcode_scan](https://github.com/Ritesh-Kumar-Mandal/Auth/blob/fad7613cb7c6b49d586e49b63585b67e7a27ccec/ScreenShots/2FA/QR-generator.png)

Use [Google Authenticator](https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en_IN&gl=US) or [Microsoft Authenticator](https://play.google.com/store/apps/details?id=com.azure.authenticator&hl=en_IN&gl=US) or any other Authenticator app to scan QR code and generate TOTP.

After registering with the QR code, enter the One Time Pin to successfully activate the 2FA.


### Please star âœ¨ repository if you like it. Thank you!
